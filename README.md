# çªèˆŸé˜ - ç²¾å“ç½‘å€å¯¼èˆªç«™



<p align="center">
  ä¸€ä¸ªä¼˜é›…ã€å¿«é€Ÿã€æ˜“äºéƒ¨ç½²çš„ä¹¦ç­¾ï¼ˆç½‘å€ï¼‰æ”¶è—ä¸åˆ†äº«å¹³å°ï¼Œå®Œå…¨åŸºäº Cloudflare å…¨å®¶æ¡¶æ„å»ºã€‚
</p>



<p align="center">
  <strong>åœ¨çº¿ä½“éªŒ:</strong> <a href="https://nav.520jacky.dpdns.org">https://nav.520jacky.dpdns.org</a>
</p>

---


## âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šå®Œç¾é€‚é…æ¡Œé¢ã€å¹³æ¿å’Œæ‰‹æœºç­‰å„ç§è®¾å¤‡ã€‚
- ğŸ¨ **ä¸»é¢˜ç¾è§‚**ï¼šç•Œé¢ç®€æ´ä¼˜é›…ï¼Œæ”¯æŒè‡ªå®šä¹‰ä¸»è‰²è°ƒã€‚
- ğŸ” **å¿«é€Ÿæœç´¢**ï¼šå†…ç½®ç«™å†…æ¨¡ç³Šæœç´¢ï¼Œè¿…é€Ÿå®šä½æ‰€éœ€ç½‘ç«™ã€‚
- ğŸ“‚ **åˆ†ç±»æ¸…æ™°**ï¼šé€šè¿‡åˆ†ç±»ç»„ç»‡ä¹¦ç­¾ï¼Œæµè§ˆç›´è§‚é«˜æ•ˆã€‚
- ğŸ”’ **å®‰å…¨åå°**ï¼šåŸºäº KV çš„ç®¡ç†å‘˜è®¤è¯ï¼Œæä¾›å®Œæ•´çš„ä¹¦ç­¾å¢åˆ æ”¹æŸ¥åå°ã€‚
- ğŸ“ **ç”¨æˆ·æäº¤**ï¼šæ”¯æŒè®¿å®¢æäº¤ä¹¦ç­¾ï¼Œç»ç®¡ç†å‘˜å®¡æ ¸åæ˜¾ç¤ºã€‚
- âš¡ **æ€§èƒ½å“è¶Š**ï¼šåˆ©ç”¨ Cloudflare è¾¹ç¼˜ç¼“å­˜ï¼Œå®ç°ç§’çº§åŠ è½½ï¼Œå¹¶æå¤§èŠ‚çœ D1 æ•°æ®åº“è¯»å–æˆæœ¬ã€‚
- ğŸ“¤ **æ•°æ®ç®¡ç†**ï¼šæ”¯æŒä¹¦ç­¾æ•°æ®çš„å¯¼å…¥ä¸å¯¼å‡ºï¼Œæ ¼å¼å…¼å®¹ï¼Œæ–¹ä¾¿è¿ç§»ã€‚




## ğŸš€ å¿«é€Ÿéƒ¨ç½²

> **å‡†å¤‡å·¥ä½œ**: ä½ éœ€è¦ä¸€ä¸ª Cloudflare è´¦å·ã€‚

### æ­¥éª¤ 1: åˆ›å»º D1 æ•°æ®åº“

1.  åœ¨ Cloudflare æ§åˆ¶å°ï¼Œè¿›å…¥ `Workers & Pages` -> `D1`ã€‚
2.  ç‚¹å‡» `åˆ›å»ºæ•°æ®åº“`ï¼Œæ•°æ®åº“åç§°è¾“å…¥ `book`ï¼Œç„¶ååˆ›å»ºã€‚

3.  è¿›å…¥æ•°æ®åº“çš„`æ§åˆ¶å°`ï¼Œæ‰§è¡Œä¸‹æ–¹çš„ SQL è¯­å¥æ¥å¿«é€Ÿåˆ›å»ºæ‰€éœ€çš„è¡¨ç»“æ„ã€‚(æ³¨æ„ç§»é™¤ä¸­æ–‡æ³¨é‡Š)

```sql
-- åˆ›å»ºå·²å‘å¸ƒç½‘ç«™è¡¨
CREATE TABLE sites (
id INTEGER PRIMARY KEY AUTOINCREMENT,
name TEXT NOT NULL,
url TEXT NOT NULL,
logo TEXT,
"desc" TEXT,
catelog TEXT NOT NULL,
status TEXT,
sort_order INTEGER NOT NULL DEFAULT 9999,
create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
update_time DATETIME DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºå¾…å®¡æ ¸ç½‘ç«™è¡¨
CREATE TABLE pending_sites (
id INTEGER PRIMARY KEY AUTOINCREMENT,
name TEXT NOT NULL,
url TEXT NOT NULL,
logo TEXT,
"desc" TEXT,
catelog TEXT NOT NULL,
status TEXT,
create_time DATETIME DEFAULT CURRENT_TIMESTAMP
);
```åˆ›å»ºæ’åˆ—é¡ºåº
ALTER TABLE sites ADD COLUMN sort_order INTEGER DEFAULT 9999;
```
> **æç¤º**: ä½¿ç”¨ SQL æ˜¯æœ€å¿«æ·çš„æ–¹å¼ã€‚å¦‚æœä½ æƒ³æ‰‹åŠ¨å»ºè¡¨ï¼Œè¯·ç¡®ä¿å­—æ®µåã€ç±»å‹ä¸ä¸Šè¿° SQL ä¸€è‡´ã€‚

### æ­¥éª¤ 2: åˆ›å»º KV å­˜å‚¨

1.  åœ¨ Cloudflare æ§åˆ¶å°ï¼Œè¿›å…¥ `Workers & Pages` -> `KV`ã€‚
2.  ç‚¹å‡» `åˆ›å»ºå‘½åç©ºé—´`ï¼Œåç§°è¾“å…¥ `NAV_AUTH`ã€‚
4f2d-2bf0-4f26-aa86-90e22286e94b)

3.  åˆ›å»ºåï¼Œä¸ºæ­¤ KV æ·»åŠ ä¸¤ä¸ªæ¡ç›®ï¼Œç”¨äºè®¾ç½®åå°ç™»å½•çš„ **ç”¨æˆ·å** å’Œ **å¯†ç **ã€‚
    -   **admin_username**: ä½ çš„ç®¡ç†å‘˜ç”¨æˆ·åï¼ˆä¾‹å¦‚ `admin`ï¼‰
    -   **admin_password**: ä½ çš„ç®¡ç†å‘˜å¯†ç 


### æ­¥éª¤ 3: åˆ›å»ºå¹¶éƒ¨ç½² Worker

1.  å›åˆ° `Workers & Pages`ï¼Œç‚¹å‡» `åˆ›å»ºåº”ç”¨ç¨‹åº` -> `åˆ›å»º Worker`ã€‚
2.  ä¸ºä½ çš„ Worker æŒ‡å®šä¸€ä¸ªåç§°ï¼ˆä¾‹å¦‚ `my-nav`ï¼‰ï¼Œç„¶åç‚¹å‡» `éƒ¨ç½²`ã€‚

3.  éƒ¨ç½²åï¼Œç‚¹å‡» `ç¼–è¾‘ä»£ç `ã€‚å°†æœ¬é¡¹ç›® `worker1.js` æ–‡ä»¶ä¸­çš„æ‰€æœ‰ä»£ç å¤åˆ¶å¹¶ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­ï¼Œæ›¿æ¢æ‰åŸæœ‰å†…å®¹ã€‚
4.  ç‚¹å‡» `éƒ¨ç½²` ä¿å­˜ä»£ç ã€‚

### æ­¥éª¤ 4: ç»‘å®šæœåŠ¡

1.  è¿›å…¥ä½ åˆšåˆšåˆ›å»ºçš„ Worker çš„ `è®¾ç½®` -> `å˜é‡`ã€‚
2.  åœ¨ **D1 æ•°æ®åº“ç»‘å®š** ä¸­ï¼Œç‚¹å‡» `æ·»åŠ ç»‘å®š`ï¼š
    -   å˜é‡åç§°: `NAV_DB`
    -   D1 æ•°æ®åº“: é€‰æ‹©ä½ åˆ›å»ºçš„ `book`
3.  åœ¨ **KV å‘½åç©ºé—´ç»‘å®š** ä¸­ï¼Œç‚¹å‡» `æ·»åŠ ç»‘å®š`ï¼š
    -   å˜é‡åç§°: `NAV_AUTH`
    -   KV å‘½åç©ºé—´: é€‰æ‹©ä½ åˆ›å»ºçš„ `NAV_AUTH`
### æ­¥éª¤ 5: å¼€å§‹ä½¿ç”¨

1.  è®¿é—®ä½ çš„ Worker åŸŸåï¼ˆä¾‹å¦‚ `my-nav.your-subdomain.workers.dev`ï¼‰ã€‚é¦–æ¬¡è®¿é—®ä¼šæç¤ºæ²¡æœ‰æ•°æ®ã€‚
2.  è®¿é—® `ä½ çš„åŸŸå/admin` è¿›å…¥åå°ï¼Œä½¿ç”¨ä½ åœ¨ **æ­¥éª¤ 2** ä¸­è®¾ç½®çš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•ã€‚
3.  åœ¨åå°æ·»åŠ ç¬¬ä¸€ä¸ªä¹¦ç­¾åï¼Œé¦–é¡µå³å¯æ­£å¸¸æ˜¾ç¤ºã€‚


### é¡¹ç›®ç»“æ„

-   `worker.js`: åŒ…å«æ‰€æœ‰åç«¯é€»è¾‘ã€API è·¯ç”±å’Œå‰ç«¯é¡µé¢æ¸²æŸ“çš„å…¥å£æ–‡ä»¶ã€‚
-   ä¸»è¦é€»è¾‘æ¨¡å—:
    -   `api`: å¤„ç†æ‰€æœ‰æ•°æ®äº¤äº’çš„ API è¯·æ±‚ã€‚
    -   `admin`: è´Ÿè´£åå°ç®¡ç†ç•Œé¢çš„æ¸²æŸ“å’Œé€»è¾‘ã€‚
    -   `handleRequest`: è´Ÿè´£å‰å°é¡µé¢çš„æ¸²æŸ“å’Œè·¯ç”±ã€‚


## ğŸ”§ æŠ€æœ¯æ ˆ

-   **è®¡ç®—**: [Cloudflare Workers](https://workers.cloudflare.com/)
-   **æ•°æ®åº“**: [Cloudflare D1](https://developers.cloudflare.com/d1/)
-   **å­˜å‚¨**: [Cloudflare KV](https://developers.cloudflare.com/workers/runtime-apis/kv/)
-   **å‰ç«¯æ¡†æ¶**: [TailwindCSS](https://tailwindcss.com/)

## ğŸŒŸ è´¡çŒ®

æ¬¢è¿é€šè¿‡ Issue æˆ– Pull Request ä¸ºæœ¬é¡¹ç›®è´¡çŒ®ä»£ç ã€æå‡ºé—®é¢˜æˆ–å»ºè®®ï¼

1.  Fork æœ¬ä»“åº“
2.  åˆ›å»ºä½ çš„åŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3.  æäº¤ä½ çš„æ›´æ”¹ (`git commit -m 'Add some amazing feature'`)
4.  æ¨é€åˆ°ä½ çš„åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5.  åˆ›å»ºä¸€ä¸ª Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT](LICENSE) è®¸å¯è¯ã€‚
